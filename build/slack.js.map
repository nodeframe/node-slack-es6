{"version":3,"sources":["../src/slack.js"],"names":["Slack","cf","globalConfig","webhook_url","username","channel","isDisable","merge","config","data","defaultField","JSON","stringify","url","body","method","headers","Promise","resolve","_fetch"],"mappings":";;;;;;;;;AAAA;;;;AACA;;;;;;;;IAEaA,K,WAAAA,K;AACX,mBAAqB;AAAA,QAATC,EAAS,uEAAJ,EAAI;;AAAA;;AACnB,QAAIC,eAAe;AACjBC,mBAAa,EADI;AAEjBC,gBAAU,EAFO;AAGjBC,eAAS,EAHQ;AAIjBC,iBAAW;AAJM,KAAnB;;AAOA,qBAAEC,KAAF,CAAQL,YAAR,EAAsBD,EAAtB;AACA,SAAKO,MAAL,GAAcN,YAAd;AACD;;;;wCAE4B;AAAA,UAAXO,IAAW,uEAAJ,EAAI;;AAC3B,UAAIC,eAAe;AACjBN,kBAAU,KAAKI,MAAL,CAAYJ,QADL;AAEjBC,iBAAS,KAAKG,MAAL,CAAYH;AAFJ,OAAnB;AAIA,uBAAEE,KAAF,CAAQG,YAAR,EAAsBD,IAAtB;AACA,aAAOE,KAAKC,SAAL,CAAeF,YAAf,CAAP;AACD;;;2BAEMG,G,EAAKC,I,EAAM;AAChB,aAAO,yBAAMD,GAAN,EAAW;AAChBE,gBAAQ,MADQ;AAEhBC,iBAAS;AACP,oBAAU,kBADH;AAEP,0BAAgB;AAFT,SAFO;AAMhBF,cAAMA;AANU,OAAX,CAAP;AAQD;;;2BAEe;AAAA,UAAXL,IAAW,uEAAJ,EAAI;;AACd,UAAG,KAAKD,MAAL,CAAYF,SAAZ,IAAyB,KAAKE,MAAL,CAAYF,SAAZ,KAA0B,MAAtD,EAA8D;AAC5D,eAAOW,QAAQC,OAAR,CAAgB;AACrB,gBAAM,IADe;AAErB,kBAAQ;AAFa,SAAhB,CAAP;AAID;AACD,aAAO,KAAKC,MAAL,CAAY,KAAKX,MAAL,CAAYL,WAAxB,EAAqCM,IAArC,CAAP;AACD","file":"slack.js","sourcesContent":["import _ from 'lodash'\nimport fetch from 'node-fetch'\n\nexport class Slack {\n  constructor(cf = {}) {\n    let globalConfig = {\n      webhook_url: '',\n      username: '',\n      channel: '',\n      isDisable: false\n    }\n\n    _.merge(globalConfig, cf)\n    this.config = globalConfig\n  }\n\n  _getStringifyData(data = {}) {\n    let defaultField = {\n      username: this.config.username,\n      channel: this.config.channel\n    }\n    _.merge(defaultField, data)\n    return JSON.stringify(defaultField)\n  }\n\n  _fetch(url, body) {\n    return fetch(url, {\n      method: 'POST',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: body\n    })\n  }\n\n  send(data = {}) {\n    if(this.config.isDisable || this.config.isDisable === 'true') {\n      return Promise.resolve({\n        \"ok\": true,\n        \"note\": \"mock the send\"\n      })\n    }\n    return this._fetch(this.config.webhook_url, data)\n  }\n}"]}